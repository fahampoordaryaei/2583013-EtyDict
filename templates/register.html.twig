{% extends 'layout.html.twig' %}
{% set url = url ?? '/' %}

{% block body %}
	<div class="d-flex justify-content-center align-items-center p-5">
		<div class="card shadow-sm p-5 login-form">
			<h1 class="mb-3 fw-semibold text-center">Create an account</h1>
			<p class="text-center mb-4 fs-4">Join the EtyDict community</p>
			<form id="register-form" class="d-flex flex-column gap-4" method="post">
				<div>
					<label for="username" class="form-label fs-5">Username</label>
					<input id="username" name="username" type="text" maxlength="15" class="form-control form-control-lg" placeholder="Username" required>
					<div class="form-text mt-1" id="username-length-error">
						Username must be 8 to 15 characters long
					</div>
					<div class="form-text text-danger mt-1 fs-5 {{ username_error ? '' : 'd-none' }}" id="username-unique-error">
						Username already exists
					</div>
				</div>
				<div>
					<label for="email" class="form-label fs-5">Email</label>
					<input id="email" name="email" type="email" class="form-control form-control-lg" placeholder="email@example.com" required>
				</div>
				<div>
					<label for="password" class="form-label fs-5">Password</label>
					<div class="input-group">
						<input id="register-password" name="password" type="password" class="form-control form-control-lg" placeholder="Password" required>
						<button type="button" class="btn btn-outline-secondary" data-password-toggle="register-password" aria-label="Toggle password visibility">
							<span aria-hidden="true"></span>
						</button>
					</div>
					<div class="form-text text-danger mt-1 d-none" id="password-error">
						Password must meet all criteria
					</div>
					<div class="password-criteria mt-3">
						<p class="fw-semibold mb-2">Password must contain:</p>
						<ol id="password-criteria" class="list-unstyled mb-0">
							<li class="" data-criteria="length">At least 8 characters</li>
							<li class="" data-criteria="uppercase">1 Uppercase character
								<strong>(A-Z)</strong>
							</li>
							<li class="" data-criteria="lowercase">1 Lowercase character
								<strong>(a-z)</strong>
							</li>
							<li class="" data-criteria="number">1 Number
								<strong>(0-9)</strong>
							</li>
							<li class="" data-criteria="special">1 Special character
								<strong>(!$#%)</strong>
							</li>
						</ol>
					</div>
				</div>
				<div>
					<label for="register-confirm-password" class="form-label fs-5">Confirm Password</label>
					<div class="input-group">
						<input id="register-confirm-password" name="confirm_password" type="password" class="form-control form-control-lg" placeholder="Confirm password" required>
					</div>
					<div class="form-text text-danger mt-1 d-none" id="register-password-match-error">Passwords must match</div>
				</div>
				<button type="submit" class="btn btn-primary btn-lg">Register</button>
				<p class="text-center text-muted mb-0">
					Already have an account?
					<a class="text-decoration-none" href="{{ url }}account/login/">Sign in</a>
				</p>
			</form>
		</div>
	</div>
{% endblock %}

{% block scripts %}
{% if register_success %}
	<div class="modal fade" id="register-success-modal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content fs-5">
				<div class="modal-header justify-content-center position-relative">
					<h4 class="modal-title text-center w-100 mb-0">Registration successful</h4>
					<button type="button" class="btn-close position-absolute end-0 top-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body d-flex flex-column align-items-center">
					<h5 class="mb-3 fw-semibold">Your account has been created.</h5>
					<p class="mb-1">Thank you for registering! Login now to get started.</p>
				</div>
				<div class="modal-footer d-flex justify-content-center gap-3">
					<a href="{{ url }}account/login/" class="btn btn-primary">Login</a>
					<a href="{{ url }}" class="btn btn-outline-secondary">Home</a>
				</div>
			</div>
		</div>
	</div>
	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const modal = document.getElementById('register-success-modal');
			if (modal) {
				const successModal = new bootstrap.Modal(modal);
				successModal.show();
			}
		});
	</script>
{% endif %}
{% endblock %}
