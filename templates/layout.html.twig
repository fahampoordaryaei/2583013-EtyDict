{% set url = url ?? '/' %}
<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous"/>
        <link rel="stylesheet" href="{{ url ~ 'assets/css/style.css' }}"/>
        <link rel="icon" type="image/png" href="{{ url ~ 'assets/img/etydict-icon.png' }}"/>
        <title>
            {% block title %}
                EtyDict
            {% endblock %}
        </title>
        {% block head %}
        {% endblock %}
    </head>

    <body class="bg-light d-flex flex-column min-vh-100">
        <nav class="d-flex justify-content-between navbar navbar-expand-lg navbar-light bg-white border-bottom px-5">
            <a class="float-start navbar-brand fw-bold p-0 m-0" href="{{ url }}">
                <img src="{{ url }}assets/img/etydict-logo.webp" alt="EtyDict Logo" width="60" height="60"/>
            </a>
            <div class="d-flex justify-content-center fw-semibold fs-4" id="nav-menu">
                <ul class="navbar-nav gap-5">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link etymology-link" href="{{ url }}etymology/">Etymology</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link dictionary-link" href="{{ url }}dictionary/">Dictionary</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url }}search/">Search</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url }}About/">About</a>
                    </li>
                </ul>
            </div>
            <div id="nav-search" class="nav-search">
                <form id="nav-search-form" class="nav-search-form d-flex align-items-center" method="post" action="{{ url }}dictionary/">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token|default('') }}">
                    <button type="button" id="nav-search-mode" class="btn nav-search-mode p-0 nav-mode-dictionary">
                        <img src="{{ url }}assets/img/dict-logo.webp" alt="Dictionary search">
                    </button>
                    <input id="nav-search-input" class="nav-search-input form-control fs-5" type="text" name="w" placeholder="Search dictionary">
                    <input type="hidden" id="nav-recaptcha-response" name="g-recaptcha-response" value="">
                    <button type="submit" id="nav-search-submit" class="btn nav-search-submit p-0">
                        <img src="{{ url }}assets/img/search.svg" alt="Search">
                    </button>
                </form>
            </div>
            {% if user is defined and user %}
                {% include 'partials/nav_logged_in.html.twig' %}
            {% else %}
                {% include 'partials/nav_logged_out.html.twig' %}
            {% endif %}
        </nav>
        {% block user_nav %}
        {% endblock %}
        <div class="row m-0 {% if default_dictionary %}{% else %}flex-grow-1{% endif %}">
            <aside id="left-side-bar" class="col-xxl-3 col-lg-2 col-md-1"></aside>
            <main class="col-xxl-6 col-lg-8 col-md-10 p-0"> {% block body %}{% endblock %}
            </main>
            <aside id="right-side-bar" class="col-xxl-3 col-lg-2 col-md-1"></aside>
        </div>
        <footer class="bg-white border-top py-3 mt-auto">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6 text-md-start text-center">
                        <img src="{{ url }}assets/img/etydict-title.webp" class="mb-2" alt="EtyDict Title" width="80"/>
                        <p class="mb-0">Free online dictionary and etymology browser.</p>
                    </div>
                    <div class="col-md-6 py-1 d-flex">
                        <div class="d-flex flex-column flex-grow-1 align-items-end">
                            <div class="align-items-center">
                                <p class="text-dark fw-semibold fs-4 mb-2 text-center">Explore</p>
                                <ul class="list-unstyled d-flex flex-md-row flex-column justify-content-center align-items-center gap-4 mb-0">
                                    <li>
                                        <a class="text-decoration-none text-black" href="{{ url }}">Home</a>
                                    </li>
                                    <li>
                                        <a class="text-decoration-none text-black" href="{{ url }}etymology/">Etymology</a>
                                    </li>
                                    <li>
                                        <a class="text-decoration-none text-black" href="{{ url }}dictionary/">Dictionary</a>
                                    </li>
                                    <li>
                                        <a class="text-decoration-none text-black" href="{{ url }}search/">Search</a>
                                    </li>
                                    <li>
                                        <a class="text-decoration-none text-black" href="{{ url }}About/">About</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center text-muted small mt-0">&copy; 2025 EtyDict. All rights reserved.</div>
            </div>
        </footer>
        <script>
            window.etydictBaseUrl = '{{ url }}';
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
        <script src="{{ url }}assets/js/script.js" defer></script>
        <script src="https://www.google.com/recaptcha/api.js?render=6LdtfCEsAAAAAPoqdfwDkqJ0PxQ5e9M8fadPxdYs"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const navForm = document.getElementById('nav-search-form');
                if (navForm) {
                    navForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        grecaptcha.ready(() => {
                            const action = navForm.action.includes('etymology') ? 'nav_etymology_search' : 'nav_dictionary_search';
                            grecaptcha.execute('6LdtfCEsAAAAAPoqdfwDkqJ0PxQ5e9M8fadPxdYs', { action: action }).then((token) => {
                                document.getElementById('nav-recaptcha-response').value = token;
                                navForm.submit();
                            });
                        });
                    });
                }
            });
        </script>
        {% block scripts %}
        {% endblock %}
    </body>
</html>
